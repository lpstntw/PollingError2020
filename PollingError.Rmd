---
title: "Polling Error"
author: "Ben Lee"
date: "11/12/2020"
output:
  github_document:
    toc: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache = TRUE, message = FALSE, warning = FALSE)
```

```{r import}

library(tidyverse)
library(knitr)
library(magrittr)
poll_raw <- read_csv("PollingError.csv")

poll <- poll_raw %>%
  mutate(r_diff2020 = Presidential_Vote_R2020 - Presidential_Poll_R2020, d_diff2020 = Presidential_Vote_D2020 - Presidential_Poll_D2020,
         r_diff2016 = Presidential_Vote_R2016 - Presidential_Poll_R2016, d_diff2016 = Presidential_Vote_D2016 - Presidential_Poll_D2016,
         r_pchange = Presidential_Poll_R2020 - Presidential_Poll_R2016, d_pchange = Presidential_Poll_D2020 - Presidential_Poll_D2016,
         r_vchange = Presidential_Vote_R2020 - Presidential_Vote_R2016, d_vchange = Presidential_Vote_D2020 - Presidential_Vote_D2016)

```
## Introduction

As the election results from Florida came in around 7 o'clock in the evening, one thing became clear: Democrat would not enjoy a landslide victory as predicted by pollsters. Florida, a state where Biden led by 2.5% according to poll aggregator, did not show a positive result for Biden. Even though 2.5% of lead in aggregate poll are definitedly within the margin of error, Democrats were shocked by the margin GOP leads. After the state was called for Trump, the final (uncertified) result shows Trump won Florida by 3.4 percent. And Florida was not alone.  

As the election results came in state by state, it seems not so much a landslide as an uphill battle for Democrats. Wisconsin, Michigan and Pennsylvania are called for Biden as the polls predicted, yet with a much smaller margin of victory. Other Midwestern states such as Ohio and Iowa, which showed a comfortable Biden lead before election, turned out to be Trump strongholds. Everyone is asking: what goes wrong (again)?  

Before all the data comes in and some analysis is conducted, we cannot know the exact answer. And possibly we will never know the exact answer. What I want to achieve here, is to see how off it is for pollster this year compared with 2016's. For the plots and analysis below, I use the poll aggregated by [FiveThirtyEight](https://projects.fivethirtyeight.com/polls/). FiveThirtyEight gained its reputation in forecasting industry as it have given a 29% winning change for Trump in 2016, while most other forecasters gave Trump only about 5% of winning chance. FiveThirtyEight relied heavily on polls to make forecast and have published weighted polling result for the past four years.  

## How the polls performed in 2020.

Below is a plot of how much do each parties outperform. The difference between GOP's vote share and its poll is drawn on x-axis whereas Democrats' is drawn on y-axis. If the source of error is the fundamental uncertainty that exists in survey, the distribution of the error should be scattered along the line of *y = -x* around (0,0). Ideally, it will be along the diagonal line because when pollster overestimate one part for 1%, it means that it underestimate the other party for 1%. And it will centered around (0,0) because error should be random.  

However, 


```{r poll error 2020}

poll %>%
  ggplot(aes(x = r_diff2020, y = d_diff2020, label = State)) +
  geom_text() + geom_abline(aes(intercept = 0, slope = -1), linetype = "dashed") +
  scale_x_continuous(limits = c(-10, 10)) + scale_y_continuous(limits = c(-10,10)) +
  labs(x = "Percentage of Republican Outperformance", y = "Percentage of Democrat Outperformance", title = "How Much Do Parties Outperform") +
  annotate(geom = "text", x = 0, y = -10, label = "On average, GOP outperformed poll for 4.28% while Democrats underperfored for 1.25%")

poll %>%
  summarise(`GOP Error` = mean(r_diff2020), `Democrat Error` = mean(d_diff2020)) %>%
  kable()  

```

```{r poll error 2016}

poll %>%
  ggplot(aes(x = r_diff2016, y = d_diff2016, label = State)) +
  geom_text() + geom_abline(aes(intercept = 0, slope = -1)) +
  scale_x_continuous(limits = c(-10, 10)) + scale_y_continuous(limits = c(-10,10))

```

## Pollsters are having a hard time with Republican voters

```{r republican change}

poll %>%
  ggplot(aes(x = r_pchange, y = r_vchange, label = State)) +
  geom_text() + geom_abline(aes(intercept = 0, slope = 1)) +
  scale_x_continuous(limits = c(-10, 10)) + scale_y_continuous(limits = c(-10,10))

```

##Pollster tends to get the change of Democrats Right


```{r democrats change}

poll %>%
  ggplot(aes(x = d_pchange, y = d_vchange, label = State)) +
  geom_text() + geom_abline(aes(intercept = 0, slope = 1)) +
  scale_x_continuous(limits = c(-10, 10)) + scale_y_continuous(limits = c(-10,10))


```

```{r regional breakown}

poll_regional <- poll %>%
  filter(!is.na(Region)) %>%
  group_by(Region) %>%
  summarise(r2020avg = mean(r_diff2020), r2020se = sd(r_diff2020),
            d2020avg = mean(d_diff2020), d2020se = sd(d_diff2020),
            r2016avg = mean(r_diff2016), r2016se = sd(r_diff2016),
            d2016avg = mean(d_diff2016), d2016se = sd(d_diff2016))

```

```{r 2020 error regional plot}

poll %>%
  filter(!is.na(Region)) %>%
  ggplot(aes(x = Region)) +
  geom_boxplot(aes(y = r_diff2020), color = "red") + geom_boxplot(aes(y = d_diff2020), color = "blue")

```

```{r 2016 erro regional plot}

poll %>%
  filter(!is.na(Region)) %>%
  ggplot(aes(x = Region)) +
  geom_boxplot(aes(y = r_diff2016), color = "red") + geom_boxplot(aes(y = d_diff2016), color = "blue")

```


